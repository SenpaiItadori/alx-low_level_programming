more malloc and free i guess
